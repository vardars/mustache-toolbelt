!function(a,b){if("object"==typeof exports&&exports)b(exports);else{var c={};b(c),"function"==typeof define&&define.amd?define(c):a.Mustache=c}}(this,function(a){function c(a,c){return b.call(a,c)}function e(a){return!c(d,a)}function h(a){return"function"==typeof a}function i(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function k(a){return String(a).replace(/[&<>"'\/]/g,function(a){return j[a]})}function l(a){if(!g(a)||2!==a.length)throw new Error("Invalid tags: "+a);return[new RegExp(i(a[0])+"\\s*"),new RegExp("\\s*"+i(a[1]))]}function r(b,c){function v(){if(k&&!r)for(;j.length;)delete h[j.pop()];else j=[];k=!1,r=!1}c=c||a.tags,b=b||"","string"==typeof c&&(c=c.split(n));for(var w,x,y,z,A,B,d=l(c),f=new u(b),g=[],h=[],j=[],k=!1,r=!1;!f.eos();){if(w=f.pos,y=f.scanUntil(d[0]))for(var C=0,D=y.length;D>C;++C)z=y.charAt(C),e(z)?j.push(h.length):r=!0,h.push(["text",z,w,w+1]),w+=1,"\n"===z&&v();if(!f.scan(d[0]))break;if(k=!0,x=f.scan(q)||"name",f.scan(m),"="===x?(y=f.scanUntil(o),f.scan(o),f.scanUntil(d[1])):"{"===x?(y=f.scanUntil(new RegExp("\\s*"+i("}"+c[1]))),f.scan(p),f.scanUntil(d[1]),x="&"):y=f.scanUntil(d[1]),!f.scan(d[1]))throw new Error("Unclosed tag at "+f.pos);if(A=[x,y,w,f.pos],h.push(A),"#"===x||"^"===x)g.push(A);else if("/"===x){if(B=g.pop(),!B)throw new Error('Unopened section "'+y+'" at '+w);if(B[1]!==y)throw new Error('Unclosed section "'+B[1]+'" at '+w)}else"name"===x||"{"===x||"&"===x?r=!0:"="===x&&(d=l(c=y.split(n)))}if(B=g.pop())throw new Error('Unclosed section "'+B[1]+'" at '+f.pos);return t(s(h))}function s(a){for(var c,d,b=[],e=0,f=a.length;f>e;++e)c=a[e],c&&("text"===c[0]&&d&&"text"===d[0]?(d[1]+=c[1],d[3]=c[3]):(b.push(c),d=c));return b}function t(a){for(var e,f,b=[],c=b,d=[],g=0,h=a.length;h>g;++g)switch(e=a[g],e[0]){case"#":case"^":c.push(e),d.push(e),c=e[4]=[];break;case"/":f=d.pop(),f[5]=e[2],c=d.length>0?d[d.length-1][4]:b;break;default:c.push(e)}return b}function u(a){this.string=a,this.tail=a,this.pos=0}function v(a,b){this.view=null==a?{}:a,this.cache={".":this.view},this.parent=b}function w(){this.cache={}}var b=RegExp.prototype.test,d=/\S/,f=Object.prototype.toString,g=Array.isArray||function(a){return"[object Array]"===f.call(a)},j={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},m=/\s*/,n=/\s+/,o=/\s*=/,p=/\s*\}/,q=/#|\^|\/|>|\{|&|=|!/;u.prototype.eos=function(){return""===this.tail},u.prototype.scan=function(a){var b=this.tail.match(a);if(b&&0===b.index){var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c}return""},u.prototype.scanUntil=function(a){var c,b=this.tail.search(a);switch(b){case-1:c=this.tail,this.tail="";break;case 0:c="";break;default:c=this.tail.substring(0,b),this.tail=this.tail.substring(b)}return this.pos+=c.length,c},v.prototype.push=function(a){return new v(a,this)},v.prototype.lookup=function(a){var b;if(a in this.cache)b=this.cache[a];else{for(var c=this;c;){if(a.indexOf(".")>0){b=c.view;for(var d=a.split("."),e=0;null!=b&&e<d.length;)b=b[d[e++]]}else b=c.view[a];if(null!=b)break;c=c.parent}this.cache[a]=b}return h(b)&&(b=b.call(this.view)),b},w.prototype.clearCache=function(){this.cache={}},w.prototype.parse=function(a,b){var c=this.cache,d=c[a];return null==d&&(d=c[a]=r(a,b)),d},w.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof v?b:new v(b);return this.renderTokens(d,e,c,a)},w.prototype.renderTokens=function(b,c,d,e){function j(a){return i.render(a,c,d)}for(var k,l,f="",i=this,m=0,n=b.length;n>m;++m)switch(k=b[m],k[0]){case"#":if(l=c.lookup(k[1]),!l)continue;if(g(l))for(var o=0,p=l.length;p>o;++o)f+=this.renderTokens(k[4],c.push(l[o]),d,e);else if("object"==typeof l||"string"==typeof l)f+=this.renderTokens(k[4],c.push(l),d,e);else if(h(l)){if("string"!=typeof e)throw new Error("Cannot use higher-order sections without the original template");l=l.call(c.view,e.slice(k[3],k[5]),j),null!=l&&(f+=l)}else f+=this.renderTokens(k[4],c,d,e);break;case"^":l=c.lookup(k[1]),(!l||g(l)&&0===l.length)&&(f+=this.renderTokens(k[4],c,d,e));break;case">":if(!d)continue;l=h(d)?d(k[1]):d[k[1]],null!=l&&(f+=this.renderTokens(this.parse(l),c,d,l));break;case"&":l=c.lookup(k[1]),null!=l&&(f+=l);break;case"name":l=c.lookup(k[1]),null!=l&&(f+=a.escape(l));break;case"text":f+=k[1]}return f},a.name="mustache.js",a.version="0.8.1",a.tags=["{{","}}"];var x=new w;a.clearCache=function(){return x.clearCache()},a.parse=function(a,b){return x.parse(a,b)},a.render=function(a,b,c){return x.render(a,b,c)},a.to_html=function(b,c,d,e){var f=a.render(b,c,d);return h(e)?(e(f),void 0):f},a.escape=k,a.Scanner=u,a.Context=v,a.Writer=w});